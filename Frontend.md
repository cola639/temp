æ˜ç™½ âœ…ï¼Œä½ è¦çš„è¡Œä¸ºæ˜¯ï¼š

---

## âœ… æœ€ç»ˆéœ€æ±‚æ€»ç»“ï¼š

### âœ… è¿‡æ»¤é€»è¾‘ï¼š

1. **query æ˜¯ç©ºå¯¹è±¡** â†’ è¿”å›æ•´ä¸ªæ•°ç»„å‰¯æœ¬
2. **query ä¸­æŸå­—æ®µä¸ºç©º**ï¼ˆ`null`ã€`undefined`ã€`''`ï¼‰â†’ å¿½ç•¥è¯¥å­—æ®µï¼Œç»§ç»­ç”¨å…¶ä»–å­—æ®µè¿‡æ»¤
3. **æ•°å­—å­—æ®µ** â†’ ç²¾ç¡®åŒ¹é… `===`
4. **å­—ç¬¦ä¸²å­—æ®µ** â†’ ä¸åŒºåˆ†å¤§å°å†™æ¨¡ç³ŠåŒ¹é…ï¼š`includes()`
5. âœ… åŸæ•°ç»„ä¸è¢«ä¿®æ”¹ï¼ˆè¿”å›çš„æ˜¯æ–°æ•°ç»„ï¼‰

---

## âœ… å°è£…å‡½æ•°å®ç°ï¼š

```js
function smartFilter(list, query) {
  // âœ… è‹¥ query æ˜¯ç©ºå¯¹è±¡ï¼Œè¿”å›å…¨éƒ¨
  if (!query || Object.keys(query).length === 0) {
    return [...list];
  }

  return list.filter((item) => {
    return Object.entries(query).every(([key, val]) => {
      if (val === undefined || val === null || val === '') {
        return true; // âœ… å¿½ç•¥ç©ºå­—æ®µï¼Œç»§ç»­åˆ¤æ–­å…¶å®ƒå­—æ®µ
      }

      const itemVal = item[key];

      if (typeof val === 'number') {
        return itemVal === val; // âœ… ç²¾ç¡®åŒ¹é…æ•°å­—
      }

      if (typeof val === 'string') {
        return (
          typeof itemVal === 'string' &&
          itemVal.toLowerCase().includes(val.toLowerCase())
        ); // âœ… å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é…
      }

      return false; // å…¶å®ƒç±»å‹å¿½ç•¥
    });
  });
}
```

---

## âœ… ç¤ºä¾‹ç”¨æ³•ï¼š

```js
const list = [
  { field1: 1, field2: 'abc' },
  { field1: 2, field2: 'xyz' },
  { field1: 1, field2: 'ABC-123' },
];

smartFilter(list, { field1: 1, field2: 'abc' });
// âœ… ç²¾ç¡®åŒ¹é… field1 === 1ï¼Œæ¨¡ç³ŠåŒ¹é… field2 åŒ…å« "abc"ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰

smartFilter(list, { field1: 1, field2: '' });
// âœ… å¿½ç•¥ field2ï¼Œåªæ ¹æ® field1 === 1 ç­›é€‰

smartFilter(list, {});
// âœ… è¿”å›æ‰€æœ‰é¡¹ï¼ˆå‰¯æœ¬ï¼‰

smartFilter(list, { field2: 'ABC' });
// âœ… åŒ¹é…æ‰€æœ‰ field2 ä¸­åŒ…å« abc çš„ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
```

---

## âœ… ç‰¹æ€§å¯¹ç…§è¡¨ï¼š

| ç‰¹æ€§                | æ˜¯å¦æ”¯æŒ âœ…        |
| ----------------- | ------------- |
| å¿½ç•¥ç©ºå­—æ®µï¼ˆval ä¸º `''`ï¼‰ | âœ…             |
| query ä¸º `{}` è¿”å›å…¨éƒ¨ | âœ…             |
| å­—ç¬¦ä¸²å­—æ®µæ¨¡ç³ŠåŒ¹é…ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ | âœ…             |
| æ•°å­—å­—æ®µç²¾ç¡®åŒ¹é… `===`    | âœ…             |
| ä¸å½±å“åŸæ•°ç»„ï¼ˆè¿”å›å‰¯æœ¬ï¼‰      | âœ… `[...list]` |

---

å¦‚ä½ éœ€è¦ï¼š

* æ”¯æŒå­—æ®µç±»å‹ä»åŸå§‹ `list` æ¨æ–­
* å­—æ®µå€¼ä¸ºæ•°ç»„æ—¶æ”¯æŒå¤šå€¼åŒ¹é…ï¼ˆå¦‚ SQL çš„ `IN`ï¼‰
* å¯é…ç½®å“ªäº›å­—æ®µå¼ºåˆ¶ç²¾ç¡®ã€å“ªäº›æ¨¡ç³Š

æˆ‘ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å°è£… ğŸ”§ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ
